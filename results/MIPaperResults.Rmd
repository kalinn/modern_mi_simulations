---
title: "MIPaperFigures"
author: "Kylie Getz and Kristin Linn"
date: "5/7/2022"
output: pdf_document
---

Results using 1000 simulations, 10 MI
trueTreatment approx -0.69, trueEcog appox 0.4

os1 <- coxph(Surv(cmonth, dead) ~ treat + genderf +  
reth_black + reth_hisp + reth_oth + practypec + b.ecogvalue + smokey +  dgradeh + surgery + site_ureter + site_renal + site_urethra + age + newVar, data=sdat.c, x=T)


```{r echo=F, include=F}
library(ggplot2)
require(gridExtra)
library(grid)
library(xtable)
library(kableExtra)

rootdir = "~/Box Sync/Mentoring/Students/Getz_Kylie/results"
fdir = file.path (rootdir, "2022_05_06")
MCAR10 <- read.csv(file.path (fdir, "MCAR10Avg10TreeV2.csv"),row.names = 1)
MCAR30 <- read.csv(file.path (fdir,"MCAR30Avg10TreeV2.csv"),row.names = 1)
MCAR50 <- read.csv(file.path (fdir,"MCAR50Avg10TreeV2.csv"),row.names = 1)
MAR10 <- read.csv(file.path (fdir,"MAR10Avg10TreeV2.csv"),row.names = 1)
MAR30 <- read.csv(file.path (fdir,"MAR30Avg10TreeV2.csv"),row.names = 1)
MAR50 <- read.csv(file.path (fdir,"MAR50Avg10TreeV2.csv"),row.names = 1)
MNAR10a <- read.csv(file.path (fdir,"MNAR10aAvg10TreeV2.csv"),row.names = 1)
MNAR30a <- read.csv(file.path (fdir,"MNAR30aAvg10TreeV2.csv"),row.names = 1)
MNAR50a <- read.csv(file.path (fdir,"MNAR50aAvg10TreeV2.csv"),row.names = 1)
MNAR10b <- read.csv(file.path (fdir,"MNAR10bAvg10TreeV2.csv"),row.names = 1)
MNAR30b <- read.csv(file.path (fdir,"MNAR30bAvg10TreeV2.csv"),row.names = 1)
MNAR50b <- read.csv(file.path (fdir,"MNAR50bAvg10TreeV2.csv"),row.names = 1)

MCAR10AE <- read.csv(file.path (fdir,"AEresult10TreeMCAR10.csv"),row.names = 1)
MCAR30AE <- read.csv(file.path (fdir,"AEresult10TreeMCAR30.csv"),row.names = 1)
MCAR50AE <- read.csv(file.path (fdir,"AEresult10TreeMCAR50.csv"),row.names = 1)
MAR10AE<- read.csv(file.path (fdir,"AEresult10TreeMAR10.csv"),row.names = 1)
MAR30AE <- read.csv(file.path (fdir,"AEresult10TreeMAR30.csv"),row.names = 1)
MAR50AE <- read.csv(file.path (fdir,"AEresult10TreeMAR50.csv"),row.names = 1)
MNAR10aAE <- read.csv(file.path (fdir,"AEresult10TreeMNAR110.csv"),row.names = 1)
MNAR30aAE <- read.csv(file.path (fdir,"AEresult10TreeMNAR130.csv"),row.names = 1)
MNAR50aAE <- read.csv(file.path (fdir,"AEresult10TreeMNAR150.csv"),row.names = 1)
MNAR10bAE <- read.csv(file.path (fdir,"AEresult10TreeMNAR210.csv"),row.names = 1)
MNAR30bAE <- read.csv(file.path (fdir,"AEresult10TreeMNAR230.csv"),row.names = 1)
MNAR50bAE <- read.csv(file.path (fdir,"AEresult10TreeMNAR250.csv"),row.names = 1)

MCAR10Full <- cbind(MCAR10,MCAR10AE)
MCAR30Full <- cbind(MCAR30,MCAR30AE)
MCAR50Full <- cbind(MCAR50,MCAR50AE)
MAR10Full <- cbind(MAR10,MAR10AE)
MAR30Full <- cbind(MAR30,MAR30AE)
MAR50Full <- cbind(MAR50,MAR50AE)
MNAR10aFull<- cbind(MNAR10a,MNAR10aAE)
MNAR30aFull<- cbind(MNAR30a,MNAR30aAE)
MNAR50aFull <- cbind(MNAR50a,MNAR50aAE)
MNAR10bFull<- cbind(MNAR10b,MNAR10bAE)
MNAR30bFull<- cbind(MNAR30b,MNAR30bAE)
MNAR50bFull <- cbind(MNAR50b,MNAR50bAE)

MCAR10AEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMCAR10.csv"),row.names = 1)
MCAR30AEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMCAR30.csv"),row.names = 1)
MCAR50AEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMCAR50.csv"),row.names = 1)
MAR10AEPerc<- read.csv(file.path (fdir,"AEpercentile10TreeMAR10.csv"),row.names = 1)
MAR30AEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMAR30.csv"),row.names = 1)
MAR50AEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMAR50.csv"),row.names = 1)
MNAR10aAEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMNAR110.csv"),row.names = 1)
MNAR30aAEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMNAR130.csv"),row.names = 1)
MNAR50aAEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMNAR150.csv"),row.names = 1)
MNAR10bAEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMNAR210.csv"),row.names = 1)
MNAR30bAEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMNAR230.csv"),row.names = 1)
MNAR50bAEPerc <- read.csv(file.path (fdir,"AEpercentile10TreeMNAR250.csv"),row.names = 1)

AETreatPerc <- rbind(cbind(MCAR10AEPerc[,1],MCAR30AEPerc[,1],MCAR50AEPerc[,1]),cbind(MAR10AEPerc[,1],MAR30AEPerc[,1],MAR50AEPerc[,1]),cbind(MNAR10aAEPerc[,1],MNAR30aAEPerc[,1],MNAR50aAEPerc[,1]),cbind(MNAR10bAEPerc[,1],MNAR30bAEPerc[,1],MNAR50bAEPerc[,1]))

PercTreatMCAR <- read.csv(file.path (fdir,"PercentileTreatMCAR10TreeV2.csv"),row.names=1 )
colnames(PercTreatMCAR)  <- c("10","30","50")
AErow <- cbind(MCAR10AEPerc[,1],MCAR30AEPerc[,1],MCAR50AEPerc[,1])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercTreatMCAR <- rbind(PercTreatMCAR,AErow)

PercEcogMCAR <- read.csv(file.path (fdir,"PercentileEcogMCAR10TreeV2.csv"),row.names=1 )
colnames(PercEcogMCAR)  <- c("10","30","50")
AErow <- cbind(MCAR10AEPerc[,2],MCAR30AEPerc[,2],MCAR50AEPerc[,2])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercEcogMCAR <- rbind(PercEcogMCAR,AErow)

PercNewVarMCAR <- read.csv(file.path (fdir,"PercentileNewVarMCAR10TreeV2.csv"),row.names=1 )
colnames(PercNewVarMCAR)  <- c("10","30","50")
AErow <- cbind(MCAR10AEPerc[,2],MCAR30AEPerc[,2],MCAR50AEPerc[,2])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercNewVarMCAR <- rbind(PercNewVarMCAR,AErow)

PercTreatMAR <- read.csv(file.path (fdir,"PercentileTreatMAR10TreeV2.csv"),row.names=1 )
colnames(PercTreatMAR)  <- c("10","30","50")
AErow <- cbind(MAR10AEPerc[,1],MAR30AEPerc[,1],MAR50AEPerc[,1])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercTreatMAR <- rbind(PercTreatMAR,AErow)

PercEcogMAR <- read.csv(file.path (fdir,"PercentileEcogMAR10TreeV2.csv"),row.names=1 )
colnames(PercEcogMAR)  <- c("10","30","50")
AErow <- cbind(MAR10AEPerc[,2],MAR30AEPerc[,2],MAR50AEPerc[,2])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercEcogMAR <- rbind(PercEcogMAR,AErow)

PercNewVarMAR <- read.csv(file.path (fdir,"PercentileNewVarMAR10TreeV2.csv"),row.names=1 )
colnames(PercNewVarMAR)  <- c("10","30","50")
AErow <- cbind(MAR10AEPerc[,2],MAR30AEPerc[,2],MAR50AEPerc[,2])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercNewVarMAR <- rbind(PercNewVarMAR,AErow)

PercTreatMNAR1 <- read.csv(file.path (fdir,"PercentileTreatMNAR10aTreeV2.csv"),row.names=1 )
colnames(PercTreatMNAR1)  <- c("10","30","50")
AErow <- cbind(MNAR10aAEPerc[,1],MNAR30aAEPerc[,1],MNAR50aAEPerc[,1])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercTreatMNAR1 <- rbind(PercTreatMNAR1,AErow)

PercEcogMNAR1 <- read.csv(file.path (fdir,"PercentileEcogMNAR10aTreeV2.csv"),row.names=1 )
colnames(PercEcogMNAR1)  <- c("10","30","50")
AErow <- cbind(MNAR10aAEPerc[,2],MNAR30aAEPerc[,2],MNAR50aAEPerc[,2])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercEcogMNAR1 <- rbind(PercEcogMNAR1,AErow)

PercNewVarMNAR1 <- read.csv(file.path (fdir,"PercentileNewVarMNAR10aTreeV2.csv"),row.names=1 )
colnames(PercNewVarMNAR1)  <- c("10","30","50")
AErow <- cbind(MNAR10aAEPerc[,2],MNAR30aAEPerc[,2],MNAR50aAEPerc[,2])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercNewVarMNAR1 <- rbind(PercNewVarMNAR1,AErow)

PercTreatMNAR2 <- read.csv(file.path (fdir,"PercentileTreatMNAR10bTreeV2.csv"),row.names=1 )
colnames(PercTreatMNAR2)  <- c("10","30","50")
AErow <- cbind(MNAR10bAEPerc[,1],MNAR30bAEPerc[,1],MNAR50bAEPerc[,1])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercTreatMNAR2 <- rbind(PercTreatMNAR2,AErow)

PercEcogMNAR2 <- read.csv(file.path (fdir,"PercentileEcogMNAR10bTreeV2.csv"),row.names=1 )
colnames(PercEcogMNAR2)  <- c("10","30","50")
AErow <- cbind(MNAR10bAEPerc[,1],MNAR30bAEPerc[,1],MNAR50bAEPerc[,1])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercEcogMNAR2 <- rbind(PercEcogMNAR2,AErow)

PercNewVarMNAR2 <- read.csv(file.path (fdir,"PercentileNewVarMNAR10bTreeV2.csv"),row.names=1 )
colnames(PercNewVarMNAR2)  <- c("10","30","50")
AErow <- cbind(MNAR10bAEPerc[,1],MNAR30bAEPerc[,1],MNAR50bAEPerc[,1])
colnames(AErow) <- c("10","30","50")
rownames(AErow) <- c("AELower","AEUpper")
PercNewVarMNAR2 <- rbind(PercNewVarMNAR2,AErow)

################################
# Table 1: Treat Bias and MSE
################################
tab1MCAR10 <-t(MCAR10[c(1,4),c(1,4,7,10)])
tab1MCAR30 <- t(MCAR30[c(1,4),c(1,4,7,10)])
tab1MCAR50 <- t(MCAR50[c(1,4),c(1,4,7,10)])
tab1MCAR <- cbind(tab1MCAR10[,1],tab1MCAR30[,1],tab1MCAR50[,1],tab1MCAR10[,2],tab1MCAR30[,2],tab1MCAR50[,2])
prop <- c(10,30,50,10,30,50)
tab1MCAR <- rbind(prop,tab1MCAR)

AEBiasMSE <- cbind(t(MCAR10AE)[1,1],t(MCAR30AE)[1,1],t(MCAR50AE)[1,1],t(MCAR10AE)[1,4],t(MCAR30AE)[1,4],t(MCAR50AE)[1,4])
tab1MCAR <- rbind(tab1MCAR,AEBiasMSE)
rownames(tab1MCAR) <- c("prop","ORACLE", "CC", "MICE", "RF", "DAE")

tab1MAR10 <-t(MAR10[c(1,4),c(1,4,7,10)])
tab1MAR30 <- t(MAR30[c(1,4),c(1,4,7,10)])
tab1MAR50 <- t(MAR50[c(1,4),c(1,4,7,10)])
tab1MAR <- cbind(tab1MAR10[,1],tab1MAR30[,1],tab1MAR50[,1],tab1MAR10[,2],tab1MAR30[,2],tab1MAR50[,2])

AEBiasMSE <- cbind(t(MAR10AE)[1,1],t(MAR30AE)[1,1],t(MAR50AE)[1,1],t(MAR10AE)[1,4],t(MAR30AE)[1,4],t(MAR50AE)[1,4])
tab1MAR <- rbind(tab1MAR,AEBiasMSE)
rownames(tab1MAR) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab1MNAR10a <-t(MNAR10a[c(1,4),c(1,4,7,10)])
tab1MNAR30a <- t(MNAR30a[c(1,4),c(1,4,7,10)])
tab1MNAR50a <- t(MNAR50a[c(1,4),c(1,4,7,10)])
tab1MNARa <- cbind(tab1MNAR10a[,1],tab1MNAR30a[,1],tab1MNAR50a[,1],tab1MNAR10a[,2],tab1MNAR30a[,2],tab1MNAR50a[,2])

AEBiasMSEa <- cbind(t(MNAR10aAE)[1,1],t(MNAR30aAE)[1,1],t(MNAR50aAE)[1,1],t(MNAR10aAE)[1,4],t(MNAR30aAE)[1,4],t(MNAR50aAE)[1,4])
tab1MNARa <- rbind(tab1MNARa,AEBiasMSEa)
rownames(tab1MNARa) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab1MNAR10b <-t(MNAR10b[c(1,4),c(1,4,7,10)])
tab1MNAR30b <- t(MNAR30b[c(1,4),c(1,4,7,10)])
tab1MNAR50b <- t(MNAR50b[c(1,4),c(1,4,7,10)])
tab1MNARb <- cbind(tab1MNAR10b[,1],tab1MNAR30b[,1],tab1MNAR50b[,1],tab1MNAR10b[,2],tab1MNAR30b[,2],tab1MNAR50b[,2])

AEBiasMSEb <- cbind(t(MNAR10bAE)[1,1],t(MNAR30bAE)[1,1],t(MNAR50bAE)[1,1],t(MNAR10bAE)[1,4],t(MNAR30bAE)[1,4],t(MNAR50bAE)[1,4])
tab1MNARb <- rbind(tab1MNARb,AEBiasMSEb)
rownames(tab1MNARb) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab1final <- rbind(tab1MCAR,tab1MAR,tab1MNARa,tab1MNARb)
print(tab1final)


################################
# Table 3: ECOG Bias and MSE
################################
tab3MCAR10 <-t(MCAR10[c(1,4),c(2,5,8,11)])
tab3MCAR30 <- t(MCAR30[c(1,4),c(2,5,8,11)])
tab3MCAR50 <- t(MCAR50[c(1,4),c(2,5,8,11)])
tab3MCAR <- cbind(tab3MCAR10[,1],tab3MCAR30[,1],tab3MCAR50[,1],tab3MCAR10[,2],tab3MCAR30[,2],tab3MCAR50[,2])
prop <- c(10,30,50,10,30,50)
tab3MCAR <- rbind(prop,tab3MCAR)

AEBiasMSE <- cbind(t(MCAR10AE)[2,1],t(MCAR30AE)[2,1],t(MCAR50AE)[2,1],t(MCAR10AE)[2,4],t(MCAR30AE)[2,4],t(MCAR50AE)[2,4])
tab3MCAR <- rbind(tab3MCAR,AEBiasMSE)
rownames(tab3MCAR) <- c("prop","ORACLE", "CC", "MICE", "RF", "DAE")

tab3MAR10 <-t(MAR10[c(1,4),c(2,5,8,11)])
tab3MAR30 <- t(MAR30[c(1,4),c(2,5,8,11)])
tab3MAR50 <- t(MAR50[c(1,4),c(2,5,8,11)])
tab3MAR <- cbind(tab3MAR10[,1],tab3MAR30[,1],tab3MAR50[,1],tab3MAR10[,2],tab3MAR30[,2],tab3MAR50[,2])

AEBiasMSE <- cbind(t(MAR10AE)[2,1],t(MAR30AE)[2,1],t(MAR50AE)[2,1],t(MAR10AE)[2,4],t(MAR30AE)[2,4],t(MAR50AE)[2,4])
tab3MAR <- rbind(tab3MAR,AEBiasMSE)
rownames(tab3MAR) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab3MNAR10a <-t(MNAR10a[c(1,4),c(2,5,8,11)])
tab3MNAR30a <- t(MNAR30a[c(1,4),c(2,5,8,11)])
tab3MNAR50a <- t(MNAR50a[c(1,4),c(2,5,8,11)])
tab3MNARa <- cbind(tab3MNAR10a[,1],tab3MNAR30a[,1],tab3MNAR50a[,1],tab3MNAR10a[,2],tab3MNAR30a[,2],tab3MNAR50a[,2])

AEBiasMSEa <- cbind(t(MNAR10aAE)[2,1],t(MNAR30aAE)[2,1],t(MNAR50aAE)[2,1],t(MNAR10aAE)[2,4],t(MNAR30aAE)[2,4],t(MNAR50aAE)[2,4])
tab3MNARa <- rbind(tab3MNARa,AEBiasMSEa)
rownames(tab3MNARa) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab3MNAR10b <-t(MNAR10b[c(1,4),c(2,5,8,11)])
tab3MNAR30b <- t(MNAR30b[c(1,4),c(2,5,8,11)])
tab3MNAR50b <- t(MNAR50b[c(1,4),c(2,5,8,11)])
tab3MNARb <- cbind(tab3MNAR10b[,1],tab3MNAR30b[,1],tab3MNAR50b[,1],tab3MNAR10b[,2],tab3MNAR30b[,2],tab3MNAR50b[,2])

AEBiasMSEb <- cbind(t(MNAR10bAE)[2,1],t(MNAR30bAE)[2,1],t(MNAR50bAE)[2,1],t(MNAR10bAE)[2,4],t(MNAR30bAE)[2,4],t(MNAR50bAE)[2,4])
tab3MNARb <- rbind(tab3MNARb,AEBiasMSEb)
rownames(tab3MNARb) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab3final <- rbind(tab3MCAR,tab3MAR,tab3MNARa,tab3MNARb)
print(tab3final)


#################################
# Table 2: Treat SE and coverage
#################################
tab2MCAR10 <-t(MCAR10[c(2,3),c(1,4,7,10)])
tab2MCAR30 <- t(MCAR30[c(2,3),c(1,4,7,10)])
tab2MCAR50 <- t(MCAR50[c(2,3),c(1,4,7,10)])
tab2MCAR <- cbind(tab2MCAR10[,1],tab2MCAR30[,1],tab2MCAR50[,1],tab2MCAR10[,2],tab2MCAR30[,2],tab2MCAR50[,2])
prop <- c(10,30,50,10,30,50)
tab2MCAR <- rbind(prop,tab2MCAR)

AEseCov <- cbind(t(MCAR10AE)[1,2],t(MCAR30AE)[1,2],t(MCAR50AE)[1,2],t(MCAR10AE)[1,3],t(MCAR30AE)[1,3],t(MCAR50AE)[1,3])
tab2MCAR <- rbind(tab2MCAR,AEseCov)
rownames(tab2MCAR) <- c("prop","ORACLE", "CC", "MICE", "RF", "DAE")

tab2MAR10 <-t(MAR10[c(2,3),c(1,4,7,10)])
tab2MAR30 <- t(MAR30[c(2,3),c(1,4,7,10)])
tab2MAR50 <- t(MAR50[c(2,3),c(1,4,7,10)])
tab2MAR <- cbind(tab2MAR10[,1],tab2MAR30[,1],tab2MAR50[,1],tab2MAR10[,2],tab2MAR30[,2],tab2MAR50[,2])

AEseCov <- cbind(t(MAR10AE)[1,2],t(MAR30AE)[1,2],t(MAR50AE)[1,2],t(MAR10AE)[1,3],t(MAR30AE)[1,3],t(MAR50AE)[1,3])
tab2MAR <- rbind(tab2MAR,AEseCov)
rownames(tab2MAR) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab2MNAR10a <-t(MNAR10a[c(2,3),c(1,4,7,10)])
tab2MNAR30a <- t(MNAR30a[c(2,3),c(1,4,7,10)])
tab2MNAR50a <- t(MNAR50a[c(2,3),c(1,4,7,10)])
tab2MNARa <- cbind(tab2MNAR10a[,1],tab2MNAR30a[,1],tab2MNAR50a[,1],tab2MNAR10a[,2],tab2MNAR30a[,2],tab2MNAR50a[,2])

AEseCov <- cbind(t(MNAR10aAE)[1,2],t(MNAR30aAE)[1,2],t(MNAR50aAE)[1,2],t(MNAR10aAE)[1,3],t(MNAR30aAE)[1,3],t(MNAR50aAE)[1,3])
tab2MNARa <- rbind(tab2MNARa,AEseCov)
rownames(tab2MNARa) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab2MNAR10b <-t(MNAR10b[c(2,3),c(1,4,7,10)])
tab2MNAR30b <- t(MNAR30b[c(2,3),c(1,4,7,10)])
tab2MNAR50b <- t(MNAR50b[c(2,3),c(1,4,7,10)])
tab2MNARb <- cbind(tab2MNAR10b[,1],tab2MNAR30b[,1],tab2MNAR50b[,1],tab2MNAR10b[,2],tab2MNAR30b[,2],tab2MNAR50b[,2])

AEseCov <- cbind(t(MNAR10bAE)[1,2],t(MNAR30bAE)[1,2],t(MNAR50bAE)[1,2],t(MNAR10bAE)[1,3],t(MNAR30bAE)[1,3],t(MNAR50bAE)[1,3])
tab2MNARb <- rbind(tab2MNARb,AEseCov)
rownames(tab2MNARb) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab2final <- rbind(tab2MCAR,tab2MAR,tab2MNARa,tab2MNARb)
print(tab2final)


#################################
# Table 4: ECOG SE and coverage
#################################
tab4MCAR10 <-t(MCAR10[c(2,3),c(2,5,8,11)])
tab4MCAR30 <- t(MCAR30[c(2,3),c(2,5,8,11)])
tab4MCAR50 <- t(MCAR50[c(2,3),c(2,5,8,11)])
tab4MCAR <- cbind(tab4MCAR10[,1],tab4MCAR30[,1],tab4MCAR50[,1],tab4MCAR10[,2],tab4MCAR30[,2],tab4MCAR50[,2])
prop <- c(10,30,50,10,30,50)
tab4MCAR <- rbind(prop,tab4MCAR)

AEseCov <- cbind(t(MCAR10AE)[2,2],t(MCAR30AE)[2,2],t(MCAR50AE)[2,2],t(MCAR10AE)[2,3],t(MCAR30AE)[2,3],t(MCAR50AE)[2,3])
tab4MCAR <- rbind(tab4MCAR,AEseCov)
rownames(tab4MCAR) <- c("prop","ORACLE", "CC", "MICE", "RF", "DAE")

tab4MAR10 <-t(MAR10[c(2,3),c(2,5,8,11)])
tab4MAR30 <- t(MAR30[c(2,3),c(2,5,8,11)])
tab4MAR50 <- t(MAR50[c(2,3),c(2,5,8,11)])
tab4MAR <- cbind(tab4MAR10[,1],tab4MAR30[,1],tab4MAR50[,1],tab4MAR10[,2],tab4MAR30[,2],tab4MAR50[,2])

AEseCov <- cbind(t(MAR10AE)[2,2],t(MAR30AE)[2,2],t(MAR50AE)[2,2],t(MAR10AE)[2,3],t(MAR30AE)[2,3],t(MAR50AE)[2,3])
tab4MAR <- rbind(tab4MAR,AEseCov)
rownames(tab4MAR) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab4MNAR10a <-t(MNAR10a[c(2,3),c(2,5,8,11)])
tab4MNAR30a <- t(MNAR30a[c(2,3),c(2,5,8,11)])
tab4MNAR50a <- t(MNAR50a[c(2,3),c(2,5,8,11)])
tab4MNARa <- cbind(tab4MNAR10a[,1],tab4MNAR30a[,1],tab4MNAR50a[,1],tab4MNAR10a[,2],tab4MNAR30a[,2],tab4MNAR50a[,2])

AEseCov <- cbind(t(MNAR10aAE)[2,2],t(MNAR30aAE)[2,2],t(MNAR50aAE)[2,2],t(MNAR10aAE)[2,3],t(MNAR30aAE)[2,3],t(MNAR50aAE)[2,3])
tab4MNARa <- rbind(tab4MNARa,AEseCov)
rownames(tab4MNARa) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab4MNAR10b <-t(MNAR10b[c(2,3),c(2,5,8,11)])
tab4MNAR30b <- t(MNAR30b[c(2,3),c(2,5,8,11)])
tab4MNAR50b <- t(MNAR50b[c(2,3),c(2,5,8,11)])
tab4MNARb <- cbind(tab4MNAR10b[,1],tab4MNAR30b[,1],tab4MNAR50b[,1],tab4MNAR10b[,2],tab4MNAR30b[,2],tab4MNAR50b[,2])

AEseCov <- cbind(t(MNAR10bAE)[2,2],t(MNAR30bAE)[2,2],t(MNAR50bAE)[2,2],t(MNAR10bAE)[2,3],t(MNAR30bAE)[2,3],t(MNAR50bAE)[2,3])
tab4MNARb <- rbind(tab4MNARb,AEseCov)
rownames(tab4MNARb) <- c("ORACLE", "CC", "MICE", "RF", "DAE")

tab4final <- rbind(tab4MCAR,tab4MAR,tab4MNARa,tab4MNARb)
print(tab4final)

tab1Treat <- round (tab1final, 4)
tab2Treat <- round (tab3final, 4)
tab3Ecog <- round (tab2final, 4)
tab4Ecog <- round (tab4final, 4)

```

\newpage

## Treatment
```{r echo=F}
lsep = c("\\addlinespace", "", "", "", "\\addlinespace", "", "", "", "\\addlinespace", "", "", "", "")

kable(tab1Treat, row.names=TRUE, align=c("l", "c", "c", "c", "c", "c", "c"), format = "latex", booktabs = T, linesep = lsep, caption = "Treatment") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = F) %>%
  add_header_above(c(" "=1, "Low"=1, "Medium"=1, "High"=1, "Low"=1, "Medium"=1, "High"=1)) %>% add_header_above(c(" "=1, "Bias"=3, "MSE"=3)) %>% group_rows (index=c (" "=1, "MCAR"=4, "MAR"=4, "MNAR"=4))

kable(tab2Treat, row.names=TRUE, align=c("l", "c", "c", "c", "c", "c", "c"), format = "latex", booktabs = T, linesep = lsep, caption = "Treatment") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = F) %>%
  add_header_above(c(" "=1, "Low"=1, "Medium"=1, "High"=1, "Low"=1, "Medium"=1, "High"=1)) %>% add_header_above(c(" "=1, "SE"=3, "Coverage"=3)) %>% group_rows (index=c (" "=1, "MCAR"=4, "MAR"=4, "MNAR"=4))
```

\newpage 

## Ecog
```{r echo=F}
kable(tab3Ecog, row.names=TRUE, align=c("l", "c", "c", "c", "c", "c", "c"), format = "latex", booktabs = T, linesep = lsep, caption = "ECOG") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = F) %>%
  add_header_above(c(" "=1, "Low"=1, "Medium"=1, "High"=1, "Low"=1, "Medium"=1, "High"=1)) %>% add_header_above(c(" "=1, "Bias"=3, "MSE"=3)) %>% group_rows (index=c (" "=1, "MCAR"=4, "MAR"=4, "MNAR"=4))

kable(tab4Ecog, row.names=TRUE, align=c("l", "c", "c", "c", "c", "c", "c"), format = "latex", booktabs = T, linesep = lsep, caption = "ECOG") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = F) %>%
  add_header_above(c(" "=1, "Low"=1, "Medium"=1, "High"=1, "Low"=1, "Medium"=1, "High"=1)) %>% add_header_above(c(" "=1, "SE"=3, "Coverage"=3)) %>% group_rows (index=c (" "=1, "MCAR"=4, "MAR"=4, "MNAR"=4))
```

\newpage

## Treat MCAR
```{r,echo=F}
upperlim <- .03
lowerlim <- -.03

lower <- data.frame(c(PercTreatMCAR[c(1,3,5,7,9),1],PercTreatMCAR[c(1,3,5,7,9),2],PercTreatMCAR[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercTreatMCAR[c(2,4,6,8,10),1],PercTreatMCAR[c(2,4,6,8,10),2],PercTreatMCAR[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMCAR<- data.frame(bias=rbind(t(MCAR10Full[1,c(1,4,7,10,13)]),t(MCAR30Full[1,c(1,4,7,10,13)]),t(MCAR50Full[1,c(1,4,7,10,13)])),sd=rbind(t(MCAR10Full[2,c(1,4,7,10,13)]),t(MCAR30Full[2,c(1,4,7,10,13)]),t(MCAR50Full[2,c(1,4,7,10,13)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMCAR)
dfMCAR <- cbind(dfMCAR,feats)
dfMCAR$feats <- factor(dfMCAR$feats, levels = dfMCAR$feats[order(dfMCAR$prop)])

dfMCAR <- dfMCAR[-c(6,11),]
dfMCAR$prop <- as.character(dfMCAR$prop)
dfMCAR[1,6]<- ""
dfMCAR$group <- as.character(dfMCAR$group)
dfMCAR$group <- factor(dfMCAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMCAR <- ggplot(dfMCAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMCARzoom <- ggplot(dfMCAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```

## Treat MAR
```{R,echo=F}
upperlim <- .03
lowerlim <- -.03

lower <- data.frame(c(PercTreatMAR[c(1,3,5,7,9),1],PercTreatMAR[c(1,3,5,7,9),2],PercTreatMAR[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercTreatMAR[c(2,4,6,8,10),1],PercTreatMAR[c(2,4,6,8,10),2],PercTreatMAR[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMAR<- data.frame(bias=rbind(t(MAR10Full[1,c(1,4,7,10,13)]),t(MAR30Full[1,c(1,4,7,10,13)]),t(MAR50Full[1,c(1,4,7,10,13)])),sd=rbind(t(MAR10Full[2,c(1,4,7,10,13)]),t(MAR30Full[2,c(1,4,7,10,13)]),t(MAR50Full[2,c(1,4,7,10,13)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMAR)
dfMAR <- cbind(dfMAR,feats)
dfMAR$feats <- factor(dfMAR$feats, levels = dfMAR$feats[order(dfMAR$prop)])

dfMAR <- dfMAR[-c(6,11),]
dfMAR$prop <- as.character(dfMAR$prop)
dfMAR[1,6]<- ""
dfMAR$group <- as.character(dfMAR$group)
dfMAR$group <- factor(dfMAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMAR <- ggplot(dfMAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMARzoom <- ggplot(dfMAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```


## Treat MNAR Setting 1
```{R,echo=F}
upperlim <- .03
lowerlim <- -.03

lower <- data.frame(c(PercTreatMNAR1[c(1,3,5,7,9),1],PercTreatMNAR1[c(1,3,5,7,9),2],PercTreatMNAR1[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercTreatMNAR1[c(2,4,6,8,10),1],PercTreatMNAR1[c(2,4,6,8,10),2],PercTreatMNAR1[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMNAR<- data.frame(bias=rbind(t(MNAR10aFull[1,c(1,4,7,10,13)]),t(MNAR30aFull[1,c(1,4,7,10,13)]),t(MNAR50aFull[1,c(1,4,7,10,13)])),sd=rbind(t(MNAR10aFull[2,c(1,4,7,10,13)]),t(MNAR30aFull[2,c(1,4,7,10,13)]),t(MNAR50aFull[2,c(1,4,7,10,13)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMNAR)
dfMNAR <- cbind(dfMNAR,feats)
dfMNAR$feats <- factor(dfMNAR$feats, levels = dfMNAR$feats[order(dfMNAR$prop)])

dfMNAR <- dfMNAR[-c(6,11),]
dfMNAR$prop <- as.character(dfMNAR$prop)
dfMNAR[1,6]<- ""
dfMNAR$group <- as.character(dfMNAR$group)
dfMNAR$group <- factor(dfMNAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMNAR1 <- ggplot(dfMNAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMNAR1zoom <- ggplot(dfMNAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```

## Treat MNAR Setting 2
```{R,echo=F}
upperlim <- .03
lowerlim <- -.03

lower <- data.frame(c(PercTreatMNAR2[c(1,3,5,7,9),1],PercTreatMNAR2[c(1,3,5,7,9),2],PercTreatMNAR2[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercTreatMNAR2[c(2,4,6,8,10),1],PercTreatMNAR2[c(2,4,6,8,10),2],PercTreatMNAR2[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMNAR<- data.frame(bias=rbind(t(MNAR10bFull[1,c(1,4,7,10,13)]),t(MNAR30bFull[1,c(1,4,7,10,13)]),t(MNAR50bFull[1,c(1,4,7,10,13)])),sd=rbind(t(MNAR10bFull[2,c(1,4,7,10,13)]),t(MNAR30bFull[2,c(1,4,7,10,13)]),t(MNAR50bFull[2,c(1,4,7,10,13)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMNAR)
dfMNAR <- cbind(dfMNAR,feats)
dfMNAR$feats <- factor(dfMNAR$feats, levels = dfMNAR$feats[order(dfMNAR$prop)])

dfMNAR <- dfMNAR[-c(6,11),]
dfMNAR$prop <- as.character(dfMNAR$prop)
dfMNAR[1,6]<- ""
dfMNAR$group <- as.character(dfMNAR$group)
dfMNAR$group <- factor(dfMNAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMNAR2 <- ggplot(dfMNAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMNAR2zoom <- ggplot(dfMNAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```

## All Treat
```{r,echo=F}
library (gridExtra)

plotMCAR = plotMCAR + ggtitle("MCAR")
plotMAR = plotMAR + ggtitle("MAR")
plotMNAR1 = plotMNAR1 + ggtitle("MNAR1")
plotMNAR2 = plotMNAR2 + ggtitle("MNAR2")
plotTxt = grid.arrange(plotMCAR, plotMAR, plotMNAR1, plotMNAR2, nrow = 2)
plot (plotTxt)

png('~/Desktop/plotAllTreat.png', width=10, height=8, units="in", pointsize=2, res=300)
plot (plotTxt)
dev.off()



plotMCARzoom = plotMCARzoom + ggtitle("MCAR")
plotMARzoom = plotMARzoom + ggtitle("MAR")
plotMNAR1zoom = plotMNAR1zoom + ggtitle("MNAR1")
plotMNAR2zoom = plotMNAR2zoom + ggtitle("MNAR2")
plotTxtZoom = grid.arrange(plotMCARzoom, plotMARzoom, plotMNAR1zoom, plotMNAR2zoom, nrow = 2)
plot (plotTxtZoom)

png('~/Desktop/plotAllTreatZoom.png', width=10, height=8, units="in", pointsize=2, res=300)
plot (plotTxtZoom)
dev.off()

```

<!--

```{r,echo=F}
if(FALSE){
dfMCAR$mech = 'MCAR'
dfMAR$mech = 'MAR'
dfMNAR$mech = 'MNAR'
tdf = rbind (dfMCAR, dfMAR, dfMNAR)
tdf$mech = factor (tdf$mech, levels=c("MCAR", "MAR", "MNAR"))

plotTxt <- ggplot(tdf, aes(x = group, y=bias, color = group))+
  ylim(lowerlim, upperlim)+
  ylab("Bias")+ 
  xlab("")+
  geom_errorbar(aes(ymax = upper, ymin = lower),
                position = "dodge", size = 1.5)+
  geom_hline(yintercept=0, linetype="dashed", color = "black")+
  geom_point(shape=16, colour="black", size=2)+
  facet_grid(cols=vars(prop), rows=vars(mech), 
             scales="free_x", space="free_x")+
  theme(legend.position = 'none', 
        panel.spacing = unit(1, "lines"),
        strip.background = element_blank(),
        axis.line = element_line(colour = "grey"),
        panel.grid.major.y = element_line(colour = "grey"),
        strip.placement = "outside",
        axis.text.x = element_text(angle = 45, hjust = 1,size=10),
        panel.background = element_rect(fill = 'white', colour = 'white'))+
  scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+
  scale_color_manual(values=mycols)+
  facet_wrap(~mech, nrow = 3)


png('~/Desktop/plotAllTreat.png', width=5, height=12, units="in", pointsize=2, res=300)
plotTxt
dev.off()

}

```

-->

## ECOG MCAR
```{r,echo=F}
upperlim <- .02
lowerlim <- -.02

lower <- data.frame(c(PercEcogMCAR[c(1,3,5,7,9),1],PercEcogMCAR[c(1,3,5,7,9),2],PercEcogMCAR[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercEcogMCAR[c(2,4,6,8,10),1],PercEcogMCAR[c(2,4,6,8,10),2],PercEcogMCAR[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMCAR<- data.frame(bias=rbind(t(MCAR10Full[1,c(2,5,8,11,14)]),t(MCAR30Full[1,c(2,5,8,11,14)]),t(MCAR50Full[1,c(2,5,8,11,14)])),sd=rbind(t(MCAR10Full[2,c(2,5,8,11,14)]),t(MCAR30Full[2,c(2,5,8,11,14)]),t(MCAR50Full[2,c(2,5,8,11,14)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMCAR)
dfMCAR <- cbind(dfMCAR,feats)
dfMCAR$feats <- factor(dfMCAR$feats, levels = dfMCAR$feats[order(dfMCAR$prop)])

dfMCAR <- dfMCAR[-c(6,11),]
dfMCAR$prop <- as.character(dfMCAR$prop)
dfMCAR[1,6]<- ""
dfMCAR$group <- as.character(dfMCAR$group)
dfMCAR$group <- factor(dfMCAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMCAR <- ggplot(dfMCAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMCARzoom <- ggplot(dfMCAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```

## ECOG MAR
```{R,echo=F}
upperlim <- .02
lowerlim <- -.02

lower <- data.frame(c(PercEcogMAR[c(1,3,5,7,9),1],PercEcogMAR[c(1,3,5,7,9),2],PercEcogMAR[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercEcogMAR[c(2,4,6,8,10),1],PercEcogMAR[c(2,4,6,8,10),2],PercEcogMAR[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMAR<- data.frame(bias=rbind(t(MAR10Full[1,c(2,5,8,11,14)]),t(MAR30Full[1,c(2,5,8,11,14)]),t(MAR50Full[1,c(2,5,8,11,14)])),sd=rbind(t(MAR10Full[2,c(2,5,8,11,14)]),t(MAR30Full[2,c(2,5,8,11,14)]),t(MAR50Full[2,c(2,5,8,11,14)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMAR)
dfMAR <- cbind(dfMAR,feats)
dfMAR$feats <- factor(dfMAR$feats, levels = dfMAR$feats[order(dfMAR$prop)])

dfMAR <- dfMAR[-c(6,11),]
dfMAR$prop <- as.character(dfMAR$prop)
dfMAR[1,6]<- ""
dfMAR$group <- as.character(dfMAR$group)
dfMAR$group <- factor(dfMAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMAR <- ggplot(dfMAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMARzoom <- ggplot(dfMAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```


## ECOG MNAR Setting 1
```{R,echo=F}
upperlim <- .02
lowerlim <- -.02

lower <- data.frame(c(PercEcogMNAR1[c(1,3,5,7,9),1],PercEcogMNAR1[c(1,3,5,7,9),2],PercEcogMNAR1[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercEcogMNAR1[c(2,4,6,8,10),1],PercEcogMNAR1[c(2,4,6,8,10),2],PercEcogMNAR1[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMNAR<- data.frame(bias=rbind(t(MNAR10aFull[1,c(2,5,8,11,14)]),t(MNAR30aFull[1,c(2,5,8,11,14)]),t(MNAR50aFull[1,c(2,5,8,11,14)])),sd=rbind(t(MNAR10aFull[2,c(2,5,8,11,14)]),t(MNAR30aFull[2,c(2,5,8,11,14)]),t(MNAR50aFull[2,c(2,5,8,11,14)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMNAR)
dfMNAR <- cbind(dfMNAR,feats)
dfMNAR$feats <- factor(dfMNAR$feats, levels = dfMNAR$feats[order(dfMNAR$prop)])

dfMNAR <- dfMNAR[-c(6,11),]
dfMNAR$prop <- as.character(dfMNAR$prop)
dfMNAR[1,6]<- ""
dfMNAR$group <- as.character(dfMNAR$group)
dfMNAR$group <- factor(dfMNAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMNAR1 <- ggplot(dfMNAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMNAR1zoom <- ggplot(dfMNAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```

## ECOG MNAR Setting 2
```{R,echo=F}
upperlim <- .02
lowerlim <- -.02

lower <- data.frame(c(PercEcogMNAR2[c(1,3,5,7,9),1],PercEcogMNAR2[c(1,3,5,7,9),2],PercEcogMNAR2[c(1,3,5,7,9),3]))
colnames(lower) <- c()
upper <- data.frame(c(PercEcogMNAR2[c(2,4,6,8,10),1],PercEcogMNAR2[c(2,4,6,8,10),2],PercEcogMNAR2[c(2,4,6,8,10),3]))
colnames(upper) <- c()



dfMNAR<- data.frame(bias=rbind(t(MNAR10bFull[1,c(2,5,8,11,14)]),t(MNAR30bFull[1,c(2,5,8,11,14)]),t(MNAR50bFull[1,c(2,5,8,11,14)])),sd=rbind(t(MNAR10bFull[2,c(2,5,8,11,14)]),t(MNAR30bFull[2,c(2,5,8,11,14)]),t(MNAR50bFull[2,c(2,5,8,11,14)])),lower,upper,group=rep(c("ORACLE","CC","MICE", "RF","DAE"),3),prop=c(rep("10%",5),rep("30%",5),rep("50%",5)))  
feats= rownames(dfMNAR)
dfMNAR <- cbind(dfMNAR,feats)
dfMNAR$feats <- factor(dfMNAR$feats, levels = dfMNAR$feats[order(dfMNAR$prop)])

dfMNAR <- dfMNAR[-c(6,11),]
dfMNAR$prop <- as.character(dfMNAR$prop)
dfMNAR[1,6]<- ""
dfMNAR$group <- as.character(dfMNAR$group)
dfMNAR$group <- factor(dfMNAR$group, levels=c("ORACLE", "CC", "MICE","RF","DAE"))

mycols = c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73")

plotMNAR2 <- ggplot(dfMNAR, aes(x = group,y=bias,color = group)) +
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)


plotMNAR2zoom <- ggplot(dfMNAR, aes(x = group,y=bias,color = group))  +ylim(lowerlim,upperlim)+
        ylab("Bias")+ xlab("")+
  geom_errorbar(aes(ymax =upper, ymin = lower),
                position = "dodge",size = 1.5)+ geom_hline(yintercept=0, linetype="dashed", color = "black")+geom_point(shape=16,colour="black",size=2)+   facet_grid(cols=vars(prop),scales = "free_x",space="free_x",switch="both") +theme(panel.spacing = unit(1, "lines"),
         strip.background = element_blank(),
         axis.line = element_line(colour = "grey"),
         panel.grid.major.y =element_line(colour = "grey"),
         strip.placement = "outside",
         axis.text.x = element_text(angle = 45, hjust = 1,size=10),
         panel.background = element_rect(fill = 'white', colour = 'white'))+ scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE"))+ theme(legend.position = 'none')+scale_color_manual(values=mycols)

```

## All ECOG
```{r,echo=F}
library (gridExtra)

plotMCAR = plotMCAR + ggtitle("MCAR")
plotMAR = plotMAR + ggtitle("MAR")
plotMNAR1 = plotMNAR1 + ggtitle("MNAR1")
plotMNAR2 = plotMNAR2 + ggtitle("MNAR2")
plotTxt = grid.arrange(plotMCAR, plotMAR, plotMNAR1, plotMNAR2, nrow = 2)
plot (plotTxt)

png('~/Desktop/plotAllECOG.png', width=10, height=8, units="in", pointsize=2, res=300)
plot (plotTxt)
dev.off()



plotMCARzoom = plotMCARzoom + ggtitle("MCAR")
plotMARzoom = plotMARzoom + ggtitle("MAR")
plotMNAR1zoom = plotMNAR1zoom + ggtitle("MNAR1")
plotMNAR2zoom = plotMNAR2zoom + ggtitle("MNAR2")
plotTxtZoom = grid.arrange(plotMCARzoom, plotMARzoom, plotMNAR1zoom, plotMNAR2zoom, nrow = 2)
plot (plotTxtZoom)

png('~/Desktop/plotAllECOGZoom.png', width=10, height=8, units="in", pointsize=2, res=300)
plot (plotTxtZoom)
dev.off()

```

