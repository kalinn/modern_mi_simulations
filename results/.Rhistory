scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE")) +
theme(legend.position = 'none') +
scale_fill_manual(values=mycols)
plotOne <- function (data, mdm, variable){
varnames = names (data)
keep = varnames[which (varnames==variable)]
data$mech = factor (data$mech)
data$method = factor (data$method, levels=c("ORACLE", "CC", "MICE", "RF", "DAE"))
data = dplyr::select (data, all_of(keep), mech, prop, method)
colnames (data)[1] = 'y'
dat = dplyr::filter (data, mech==mdm)
datOracle = dplyr::filter (dat, method=='ORACLE' & prop==10)
dat = dplyr::filter (dat, !(method=='ORACLE'))
datOracle$prop = ""
fdat = rbind (datOracle, dat)
gg = ggplot(fdat, aes(x=method, y=y, fill=method)) +
ylab("Estimate - True") +
xlab("") +
geom_boxplot() +
#    geom_errorbar(aes(ymax = Upper, ymin = Lower), position = "dodge",size = 1.5) +
geom_hline(yintercept=0, linetype="dashed", color="black") +
#    geom_point(shape=16,colour="black",size=2) +
#    facet_grid(cols=vars(prop), scales = "free_x", space="free_x", switch="both") +
facet_grid(cols=vars(prop), scales = "free", space="free", switch="both") +
theme(panel.spacing = unit(1, "lines"),
strip.background = element_blank(),
axis.line = element_line(colour = "grey"),
panel.grid.major.y = element_line(colour = "grey"),
strip.placement = "outside",
axis.text.x = element_text(angle = 45, hjust = 1, size=8),
panel.background = element_rect(fill = 'white', colour = 'white')) +
scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE")) +
theme(legend.position = 'none') +
scale_fill_manual(values=mycols)
return (gg)
}
percPlot = function (data, variable){
mcar = plotOne (data, mdm='MCAR', variable)
mar = plotOne (data, mdm='MAR', variable)
mnar1 = plotOne (data, mdm='MNAR1', variable)
mnar2 = plotOne (data, mdm='MNAR2', variable)
op = grid.arrange(mcar, mar, mnar1, mnar2, nrow = 2)
return (op)
}
percPlot(allData, 'treat')
plotOne <- function (data, mdm, variable){
varnames = names (data)
keep = varnames[which (varnames==variable)]
data$mech = factor (data$mech)
data$method = factor (data$method, levels=c("ORACLE", "CC", "MICE", "RF", "DAE"))
data = dplyr::select (data, all_of(keep), mech, prop, method)
colnames (data)[1] = 'y'
dat = dplyr::filter (data, mech==mdm)
datOracle = dplyr::filter (dat, method=='ORACLE' & prop==10)
dat = dplyr::filter (dat, !(method=='ORACLE'))
datOracle$prop = ""
fdat = rbind (datOracle, dat)
gg = ggplot(fdat, aes(x=method, y=y, fill=method)) +
ylab("Estimate - True") +
xlab("") +
geom_boxplot() +
#    geom_errorbar(aes(ymax = Upper, ymin = Lower), position = "dodge",size = 1.5) +
geom_hline(yintercept=0, linetype="dashed", color="black") +
#    geom_point(shape=16,colour="black",size=2) +
#    facet_grid(cols=vars(prop), scales = "free_x", space="free_x", switch="both") +
facet_grid(cols=vars(prop), scales = "free", space="fixed", switch="both") +
theme(panel.spacing = unit(1, "lines"),
strip.background = element_blank(),
axis.line = element_line(colour = "grey"),
panel.grid.major.y = element_line(colour = "grey"),
strip.placement = "outside",
axis.text.x = element_text(angle = 45, hjust = 1, size=8),
panel.background = element_rect(fill = 'white', colour = 'white')) +
scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE")) +
theme(legend.position = 'none') +
scale_fill_manual(values=mycols)
return (gg)
}
percPlot(allData, 'treat')
plotOne <- function (data, mdm, variable){
varnames = names (data)
keep = varnames[which (varnames==variable)]
data$mech = factor (data$mech)
data$method = factor (data$method, levels=c("ORACLE", "CC", "MICE", "RF", "DAE"))
data = dplyr::select (data, all_of(keep), mech, prop, method)
colnames (data)[1] = 'y'
dat = dplyr::filter (data, mech==mdm)
datOracle = dplyr::filter (dat, method=='ORACLE' & prop==10)
dat = dplyr::filter (dat, !(method=='ORACLE'))
datOracle$prop = ""
fdat = rbind (datOracle, dat)
gg = ggplot(fdat, aes(x=method, y=y, fill=method)) +
ylab("Estimate - True") +
xlab("") +
geom_boxplot() +
#    geom_errorbar(aes(ymax = Upper, ymin = Lower), position = "dodge",size = 1.5) +
geom_hline(yintercept=0, linetype="dashed", color="black") +
#    geom_point(shape=16,colour="black",size=2) +
#    facet_grid(cols=vars(prop), scales = "free_x", space="free_x", switch="both") +
facet_grid(cols=vars(prop), scales = "free_y", space="free", switch="both") +
theme(panel.spacing = unit(1, "lines"),
strip.background = element_blank(),
axis.line = element_line(colour = "grey"),
panel.grid.major.y = element_line(colour = "grey"),
strip.placement = "outside",
axis.text.x = element_text(angle = 45, hjust = 1, size=8),
panel.background = element_rect(fill = 'white', colour = 'white')) +
scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE")) +
theme(legend.position = 'none') +
scale_fill_manual(values=mycols)
return (gg)
}
percPlot(allData, 'treat')
plotOne <- function (data, mdm, variable){
varnames = names (data)
keep = varnames[which (varnames==variable)]
data$mech = factor (data$mech)
data$method = factor (data$method, levels=c("ORACLE", "CC", "MICE", "RF", "DAE"))
data = dplyr::select (data, all_of(keep), mech, prop, method)
colnames (data)[1] = 'y'
dat = dplyr::filter (data, mech==mdm)
datOracle = dplyr::filter (dat, method=='ORACLE' & prop==10)
dat = dplyr::filter (dat, !(method=='ORACLE'))
datOracle$prop = ""
fdat = rbind (datOracle, dat)
gg = ggplot(fdat, aes(x=method, y=y, fill=method)) +
ylab("Estimate - True") +
xlab("") +
geom_boxplot() +
#    geom_errorbar(aes(ymax = Upper, ymin = Lower), position = "dodge",size = 1.5) +
geom_hline(yintercept=0, linetype="dashed", color="black") +
#    geom_point(shape=16,colour="black",size=2) +
#    facet_grid(cols=vars(prop), scales = "free_x", space="free_x", switch="both") +
facet_grid(cols=vars(prop), scales = "free_x", space="free", switch="both") +
theme(panel.spacing = unit(1, "lines"),
strip.background = element_blank(),
axis.line = element_line(colour = "grey"),
panel.grid.major.y = element_line(colour = "grey"),
strip.placement = "outside",
axis.text.x = element_text(angle = 45, hjust = 1, size=8),
panel.background = element_rect(fill = 'white', colour = 'white')) +
scale_x_discrete(breaks=c("CC","MICE","RF","DAE","ORACLE")) +
theme(legend.position = 'none') +
scale_fill_manual(values=mycols)
return (gg)
}
percPlot = function (data, variable){
mcar = plotOne (data, mdm='MCAR', variable)
mar = plotOne (data, mdm='MAR', variable)
mnar1 = plotOne (data, mdm='MNAR1', variable)
mnar2 = plotOne (data, mdm='MNAR2', variable)
op = grid.arrange(mcar, mar, mnar1, mnar2, nrow = 2)
return (op)
}
percPlot(allData, 'treat')
vars = names (allData)
vars
vars = names (allData)[1:16]
for (i in 1:length (vars)){
pdf (paste0 ('~/Desktop/mi_plots/', vars[i], '.csv'))
percPlot(allData, vars[i])
dev.off()
}
vars = names (allData)[1:16]
for (i in 1:length (vars)){
pdf (paste0 ('~/Desktop/mi_plots/', vars[i], '.csv'))
percPlot(allData, vars[i])
dev.off()
}
vars = names (allData)[1:16]
for (i in 1:length (vars)){
print (i)
pdf (paste0 ('~/Desktop/mi_plots/', vars[i], '.pdf'))
percPlot(allData, vars[i])
dev.off()
}
library(ggplot2)
library(gridExtra)
library(grid)
library(xtable)
library(kableExtra)
library(dplyr)
library(reshape2)
rootdir = "~/Box Sync/Mentoring/Students/Getz_Kylie/results"
fdir = file.path (rootdir, "2022_05_22")
mcar = read.csv (file.path (fdir), "evalImputations_MCAR.csv")
mcar = read.csv (file.path (fdir, "evalImputations_MCAR.csv"))
mar = read.csv (file.path (fdir, "evalImputations_MAR.csv"))
mnar1 = read.csv (file.path (fdir, "evalImputations_MCAR1.csv"))
mnar1 = read.csv (file.path (fdir, "evalImputations_MNAR1.csv"))
mnar2 = read.csv (file.path (fdir, "evalImputations_MNAR2.csv"))
head(mcar)
melt
?melt
data = mar
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
mae = select (data, X, miceAvgMAE, rfAvgMAE, mech, prop, id.vars=c("X", "mech", "prop"))
mse = select (data, X, miceAvgMSE, rfAvgMSE, mech, prop, id.vars=c("X", "mech", "prop"))
head(md)
factor (md$variable)
md$variable = factor (md$variable, levels=c("MICE", "RF"))
mae$variable = factor (mae$variable, levels=c("MICE", "RF"))
mae = select (data, X, miceAvgMAE, rfAvgMAE, mech, prop, id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, levels=c("MICE", "RF"))
mse = select (data, X, miceAvgMSE, rfAvgMSE, mech, prop, id.vars=c("X", "mech", "prop"))
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, levels=c("MICE", "RF"))
mae = select (data, X, miceAvgMAE, rfAvgMAE, mech, prop, id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, levels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, levels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, levels=c("MICE", "RF"))
head(mse)
?factor
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
head (mse)
dim(mse)
450/16
450/3
unique (md$X)
unique (mcar$X)
rm(list=ls())
rootdir = "~/Box Sync/Mentoring/Students/Getz_Kylie/results"
fdir = file.path (rootdir, "2022_05_22")
mcar = read.csv (file.path (fdir, "evalImputations_MCAR.csv"))
mar = read.csv (file.path (fdir, "evalImputations_MAR.csv"))
mnar1 = read.csv (file.path (fdir, "evalImputations_MNAR1.csv"))
mnar2 = read.csv (file.path (fdir, "evalImputations_MNAR2.csv"))
data = mar
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
head(md)
dim(md)
45000/2
22500/3
7500/500
unique (md$X)
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
head(md)
ggMD = ggplot (md, aes (x=X, y=value)) + facet_wrap(~mech+prop)
plot (ggMD)
ggMD = ggplot (md, aes (x=X, y=value)) + facet_wrap(~prop) + geom_boxplot()
plot (ggMD)
mycols = rep (c ("#D55E00", "#E69F00", "#2271B2", "#3DB7E9", "#359B73"), 5)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Average (imputations) Mean (observations within imputation) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 45, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMD)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Average (imputations) Mean (observations within imputation) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMD)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMD)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMD)
mycols = rep (c ("#FF6666", "#CCFF66", "#5D2E8C", "#2EC4B6", "#F1E8B8", "EE60F0", "EC9DED", "F1CEF1", "2865F1", "6792F3", "A5BDF5", "E9E5E1", "E71367", "13E790", "84EBC1"), 5)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMD)
mycols = rep (c ("#FF6666", "#CCFF66", "#5D2E8C", "#2EC4B6", "#F1E8B8", "#EE60F0", "#EC9DED", "#F1CEF1", "#2865F1", "#6792F3", "#A5BDF5", "#E9E5E1", "#E71367", "#13E790", "#84EBC1"), 5)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMD)
mycols = rep (c ("#FF6666", "#CCFF66", "#5D2E8C", "#2EC4B6", "#F1E8B8", "#EE60F0", "#EC9DED", "#F1CEF1", "#2865F1", "#6792F3", "#A5BDF5", "#E9E5E1", "#E71367", "#13E790", "#99EAC9"), 5)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMAE)
ggMSE = ggplot (mse, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean Squared Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
plot (ggMSE)
makePlots = function (data){
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
return (list ('md'=ggMD, 'mae'=ggMAE))
}
plotMCAR = makePlots(mcar)
plotMAR = makePlots(mar)
plotMAR = makePlots(mar)
plotMNAR1 = makePlots(mnar1)
plotMNAR2 = makePlots(mcar2)
plotMNAR2 = makePlots(mnar2)
plot (plotMCAR$md)
?ylim
?coord_cartesian
plot (plotMCAR$md + coord_cartesian(ylim=c(-0.01, 0.01)))
mycols = rep (c ("#FF6666", "#CCFF66", "#5D2E8C", "#2EC4B6", "#F1E8B8", "#EE60F0", "#EC9DED", "#F1CEF1", "#FFAA00", "#FFCD6A", "#FFDC97", "#A0A0A0", "#E9E5E1", "#FFDC97", "#CDFFFD"), 5)
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
makePlots = function (data){
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
return (list ('md'=ggMD, 'mae'=ggMAE))
}
plotMCAR = makePlots(mcar)
plot (plotMCAR$md)
plot (plotMCAR$md + coord_cartesian(ylim=c(-0.01, 0.01)))
mycols = rep (c ("#FF6666", "#CCFF66", "#5D2E8C", "#2EC4B6", "#F1E8B8", "#EE60F0", "#EC9DED", "#F1CEF1", "#FFAA00", "#FFCD6A", "#FFDC97", "#A0A0A0", "#E9E5E1", "#71FCFE", "#CDFFFD"), 5)
makePlots = function (data){
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
return (list ('md'=ggMD, 'mae'=ggMAE))
}
plotMCAR = makePlots(mcar)
plot (plotMCAR$md)
plot (plotMCAR$md + coord_cartesian(ylim=c(-0.01, 0.01)))
plotMAR = makePlots(mar)
plotMNAR1 = makePlots(mnar1)
plotMNAR2 = makePlots(mnar2)
plot (plotMCAR$mae)
plot (plotMCAR$mae + coord_cartesian(ylim=c(-0.01, 0.01)))
plot (plotMCAR$mae + coord_cartesian(ylim=c(0, 0.03)))
plot (plotMAR$md)
plot (plotMAR$md + coord_cartesian(ylim=c(-0.01, 0.01)))
plot (plotMAR$mae)
plot (plotMAR$mae + coord_cartesian(ylim=c(0, 0.03)))
plot (plotMNAR1$md)
plot (plotMNAR1$md + coord_cartesian(ylim=c(-0.01, 0.01)))
?facet_wrap
makePlots = function (data){
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop+variable, nrow=2) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~prop+variable, nrow=2) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
return (list ('md'=ggMD, 'mae'=ggMAE))
}
plotMCAR = makePlots(mcar)
plotMAR = makePlots(mar)
plotMNAR1 = makePlots(mnar1)
plotMNAR2 = makePlots(mnar2)
plot (plotMCAR$md)
makePlots = function (data){
md = melt (select (data, X, miceAvgMD, rfAvgMD, mech, prop), id.vars=c("X", "mech", "prop"))
md$variable = factor (md$variable, labels=c("MICE", "RF"))
mae = melt (select (data, X, miceAvgMAE, rfAvgMAE, mech, prop), id.vars=c("X", "mech", "prop"))
mae$variable = factor (mae$variable, labels=c("MICE", "RF"))
mse = melt (select (data, X, miceAvgMSE, rfAvgMSE, mech, prop), id.vars=c("X", "mech", "prop"))
mse$variable = factor (mse$variable, labels=c("MICE", "RF"))
ggMD = ggplot (md, aes (x=X, y=value, fill=X)) +
facet_wrap(~variable+prop, nrow=2) + geom_boxplot() +
ylab("Avg (imputations) Mean (obs in imp) Difference") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
ggMAE = ggplot (mae, aes (x=X, y=value, fill=X)) +
facet_wrap(~variable+prop, nrow=2) + geom_boxplot() +
ylab("Avg (imputations) Mean Abs Error") +
xlab("") +
theme(legend.position = 'none',
axis.text.x = element_text(angle = 75, hjust = 1, size=8)) +
scale_fill_manual(values=mycols)
return (list ('md'=ggMD, 'mae'=ggMAE))
}
plotMCAR = makePlots(mcar)
plotMAR = makePlots(mar)
plotMNAR1 = makePlots(mnar1)
plotMNAR2 = makePlots(mnar2)
plot (plotMCAR$md)
plot (plotMCAR$md + coord_cartesian(ylim=c(-0.01, 0.01)))
)
plot (plotMCAR$md + coord_cartesian(ylim=c(-0.005, 0.005)))
plot (plotMCAR$md + coord_cartesian(ylim=c(-0.005, 0.005)))
plot (plotMCAR$mae)
plot (plotMAR$md)
plot (plotMAR$md + coord_cartesian(ylim=c(-0.005, 0.005)))
plot (plotMAR$md + coord_cartesian(ylim=c(-0.01, 0.01)))
plot (plotMAR$mae)
plot (plotMAR$mae + coord_cartesian(ylim=c(0, 0.03)))
plot (plotMAR$mae + coord_cartesian(ylim=c(0, 0.05)))
plot (plotMAR$mae)
plot (plotMAR$mae + coord_cartesian(ylim=c(0, 0.05)))
plot (plotMNAR1$md)
plot (plotMNAR1$md + coord_cartesian(ylim=c(-0.01, 0.01)))
plot (plotMNAR1$mae)
plot (plotMNAR1$mae + coord_cartesian(ylim=c(0, 0.05)))
plot (plotMNAR2$md)
plot (plotMNAR2$md + coord_cartesian(ylim=c(-0.01, 0.01)))
plot (plotMNAR2$mae)
plot (plotMNAR2$mae + coord_cartesian(ylim=c(0, 0.05)))
plot (plotMNAR2$mae + coord_cartesian(ylim=c(0, 0.05)))
